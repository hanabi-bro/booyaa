from urllib.parse import urljoin

class SwitchControllerManagedSwitch:
    def __init__(self, api):
        self.api = api
        self.switch_list = []
        #[
        #    {
        #        'name': 'switch_name',
        #        'serial': 'serial',
        #        'status': 'Connected',
        #        'connecting_from': 'IP address',
        #        'state': 'Authorized',
        #    }
        #]

    def get(self, scope='global'):
        api_path =  'monitor/switch-controller/managed-switch'
        url = urljoin(self.api.base_url, api_path)

        params = {
            'scope': scope
        }

        kwargs = {
            'method': 'get',
            'params': params,
            'req_format': 'data',
            'res_format': 'json'
        }

        let = self.api.req(url, **kwargs)

        for sw in let['output']['results']:
            sw.setdefault('connecting_from', '-')
            self.switch_list.append(
                {
                    'name': sw['name'],
                    'serial': sw['serial'],
                    'status': sw['status'],
                    'ip_addr': sw['connecting_from'],
                    'state': sw['state'],
                }
            )

        return let

"""
{
  "http_method":"GET",
  "results":[
    {
      "name":"S224ENTF18000490",
      "serial":"S224ENTF18000490",
      "fgt_peer_intf_name":"flink1",
      "state":"Authorized",
      "status":"Connected",
      "os_version":"S224EN-v7.4.3-build830,240422 (GA)",
      "connecting_from":"10.255.1.1",
      "join_time":"Mon Jul 28 15:30:58 2025\n",
      "ports":[
        {
          "interface":"port1",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port2",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port3",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port4",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port5",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port6",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port7",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port8",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port9",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port10",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port11",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port12",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port13",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port14",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port15",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port16",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port17",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port18",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port19",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port20",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port21",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port22",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port23",
          "fortilink_port":true,
          "vlan":"_default",
          "fgt_peer_port_name":"a",
          "fgt_peer_device_name":"FGT60FTK20099VM6",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"up",
          "duplex":"full",
          "speed":1000
        },
        {
          "interface":"port24",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"S224EPTF20005577",
          "isl_peer_port_name":"port24",
          "isl_peer_trunk_name":"4EPTF20005577-0",
          "mclag_icl":false,
          "mclag":false,
          "status":"up",
          "duplex":"full",
          "speed":1000
        },
        {
          "interface":"port25",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port26",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port27",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port28",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        }
      ],
      "max_poe_budget":0,
      "igmp_snooping_supported":true,
      "dhcp_snooping_supported":true,
      "mc_lag_supported":true,
      "led_blink_supported":true,
      "type":"physical",
      "faceplate_xml":"<model type=\"s224en\">\n\t<portgroup id=\"portgroup1\">\n\t\t<port id=\"mgmt\" label=\"MGMT\"\/>\n\t<\/portgroup>\n\t<portgroup id=\"portgroup2\" label=\"\" rows=\"2\">\n\t\t<port id=\"port\" start=\"1\" switch_name=\"fsw\" num=\"24\"\/>\n\t<\/portgroup>\n\t<portgroup id=\"portgroup3\" label=\"SFP\" rows=\"2\">\n\t\t<port id=\"port\" start=\"25\" switch_name=\"fsw\" type=\"fiber\" num=\"4\"\/>\n\t<\/portgroup>\n<\/model>\n",
      "vdom":"root",
      "is_l3":false
    },
    {
      "name":"S224EPTF20005577",
      "serial":"S224EPTF20005577",
      "fgt_peer_intf_name":"flink1",
      "state":"DeAuthorized",
      "status":"Idle",
      "ports":[
        {
          "interface":"port1",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port2",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port3",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port4",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port5",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port6",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port7",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port8",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port9",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port10",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port11",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port12",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port13",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port14",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port15",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port16",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port17",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port18",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port19",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port20",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port21",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port22",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port23",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port24",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"S224ENTF18000490",
          "isl_peer_port_name":"port24",
          "isl_peer_trunk_name":"4ENTF18000490-0",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port25",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port26",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port27",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        },
        {
          "interface":"port28",
          "fortilink_port":false,
          "vlan":"_default",
          "fgt_peer_port_name":"",
          "fgt_peer_device_name":"",
          "isl_peer_device_name":"",
          "isl_peer_port_name":"",
          "isl_peer_trunk_name":"",
          "mclag_icl":false,
          "mclag":false,
          "status":"down"
        }
      ],
      "max_poe_budget":180,
      "igmp_snooping_supported":true,
      "dhcp_snooping_supported":true,
      "mc_lag_supported":true,
      "led_blink_supported":true,
      "type":"physical",
      "faceplate_xml":'<model type=\"s224ep\">\n\t<portgroup id=\"portgroup1\">\n\t\t<port id=\"mgmt\" label=\"MGMT\"\/>\n\t<\/portgroup>\n\t<portgroup id=\"portgroup2\" label=\"PoE+\" rows=\"2\" poe=\"true\">\n\t\t<port id=\"port\" start=\"1\" switch_name=\"fsw\" num=\"12\"\/>\n\t<\/portgroup>\n\t<portgroup id=\"portgroup3\" label=\"\" rows=\"2\">\n\t\t<port id=\"port\" start=\"13\" switch_name=\"fsw\" num=\"12\"\/>\n\t<\/portgroup>\n\t<portgroup id=\"portgroup4\" label=\"SFP\" rows=\"2\">\n\t\t<port id=\"port\" start=\"25\" switch_name=\"fsw\" type=\"fiber\" num=\"4\"\/>\n\t<\/portgroup>\n<\/model>\n',
      "vdom":"root",
      "is_l3":false
    }
  ],
  "vdom":"root",
  "path":"switch-controller",
  "name":"managed-switch",
  "action":"",
  "status":"success",
  "serial":"FGT60FTK20099VM6",
  "version":"v7.0.17",
  "build":682
}                                                                                                                                                                                                            âœ“
"""